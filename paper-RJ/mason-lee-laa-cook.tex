% !TeX root = RJwrapper.tex
\title{Teaching Computers to See Patterns in Scatterplots with
Scagnostics}
\author{by Harriet Mason, Stuart Lee, Ursula Laa, and Dianne Cook}

\maketitle

\abstract{%
As the number of dimensions in a dataset increases, the process of
visualising its structure and variable dependencies becomes more
tedious. Scagnostics (scatterplot diagnostics) are a set of visual
features that can be used to identify interesting and abnormal
scatterplots, and thus give a sense of priority to the variables we
choose to visualise. Here, we will discuss the creation of the
\emph{cassowaryr} R package that will provide a user-friendly method to
calculate these scagnostics, as well as the development of adjusted
measures not previously defined in the literature. The package is be
tested on datasets with known interesting visual features to ensure the
scagnostics are working as expected,before being applied to time series,
physics and AFLW data to show their value as a preliminary step in
exploratory data analysis.
}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

Visualising high dimensional data is often difficult and requires a
trade-off between the usefulness of the plots and maintaining the
structures of the original data. This is because the number of possible
pairwise plots rises exponentially with the number of dimensions.
Datasets like Anscombe's quartet \citep{anscombe} or the datasaurus
dozen \citep{datasaurpkg} have been constructed such that each pairwise
plot has the same summary statistics but strikingly different visual
features. This design is to illustrate the pitfalls of numerical
summaries and the importance of visualisation. This means that despite
the issues that come with increasing dimensionality, visualisation of
the data cannot be ignored. Scagnostics offer one possible solution to
this issue.

The term scagnostics was introduced by John Tukey in 1982 \citep{tukey}.
Tukey discusses the value of a cognostic (a diagnostic that should be
interpreted by a computer rather than a human) to filter out
uninteresting visualisations. He denotes a cognostic that is specific to
scatter plots a scagnostic. Up to a moderate number of variables, a
scatter plot matrix (SPLOM) can be used to create pairwise
visualisations, however, this solution quickly becomes infeasible. Thus,
instead of trying to view every possible variable combination, the
workload is reduced by calculating a series of visual features, and only
presenting the outlier scatter plots on these feature combinations.

There is a large amount of research into visualising high dimensional
data, most of which focuses on some form of dimension reduction. This
can be done by creating a hierarchy of potential variables, performing a
transformation of the variables, or some combination of the two.
Unfortunately none of these methods are without pitfalls. Linear
transformations are subject to crowding, where low level projections
concentrate data in the centre of the distribution, making it difficult
to differentiate data points \citep{crowding}. Non-linear
transformations often have complex parameterisations, and can break the
underlying global structure of the data, creating misleading
visualisations. While there are solutions within these methods to fix
these issues such as a burning sage tour which zooms in further on
points closer to the middle of a tour to prevent crowding
\citep{burningsage}, or the liminal package which facilitates linked
brushing between a non-linear and linear data transformations to
maintaining global structure \citep{liminal}, all these methods still
involve some transformation of the data. Scagnostics gives the benefit
of allowing the user to view relationships between the variables in
their raw form. This means they are not subject to the linear
transformation issue of crowding, or the non-linear transformation issue
of misleading global structures. That being said, only viewing pairwise
plots can leave our variable interpretations without context. Methods
such as those shown in \emph{ScagExplorer} \citep{scagexplorer} try to
address this by visualising the pairwise plots in relation to the
scagnostic measures distribution, but ultimately the lack of context
remains one of the limitations of using scagnostics alone as a dimension
reduction technique.

Scagnostics are not only useful in isolation, they can be applied in
conjunction with other techniques to find interesting feature
combinations of the transformed variables. The tourr projection pursuit
currently uses a selection of scagnostics to identify interesting low
level projections and move the visualisation towards them
\citep{tourrpp}. Since scagnostics are not dependent on the type of
data, they can also be used to compare and contrast scatter plots
regardless of the discipline. In this way, they are a useful metric for
something like the comparisons described in \emph{A self-organizing,
living library of time-series data}, which tries to organise time series
by their features instead of on their metadata \citep{sots}.

Several scagnostics have been previously defined in
\emph{Graph-Theoretic Scagnostics} \citep{scag}, which are typically
considered the basis of the visual features. They were all constructed
to range {[}0,1{]}, and later scagnostics have maintained this scale.
The formula for these measures were revised in \emph{Scagnostic
Distributions} and are still calculated according to this paper
\citep{scagdist}. In addition to the main nine, the benefit of using two
additional association scagnostics were discussed in Katrin Grimm's PhD
thesis \citep{Grimm}. These two association measures are also used in
the tourr projection pursuit \citep{tourrpp}.

There are two existing scagnostics packages, \emph{scagnostics}
\citep{scagdist} and the archived package \emph{binostics}
\citep{binostics}. Both are based on the original C++ code from
\emph{Scagnostic Distributions} \citep{scagdist}, which is difficult to
read and difficult to debug. Thus there is a need for a new
implementation that enables better diagnosis of the scagnostics, and
better graphical tools for examining the results.

This paper describes the R package, \texttt{cassowaryr} that computes
the currently existing scagnostics, and adds several new measures. The
paper is organised as follows. The next section explains the
scagnostics. This is followed by a description of the implementation.
Several examples using collections of time series and XXX illustrate the
usage.

\hypertarget{scagnostics}{%
\section{Scagnostics}\label{scagnostics}}

\hypertarget{building-blocks-for-the-graph-based-metrics}{%
\subsection{Building blocks for the graph-based
metrics}\label{building-blocks-for-the-graph-based-metrics}}

In order to capture the visual structure of the data, graph theory is
used to calculate most of the scagnostics. The pairwise scatter plot is
re-constructed as a graph with the data points as vertices and the edges
are calculated using Delaunay triangulation. In the package, this
calculation is done using the alphahull package \citep{alphahull} to
construct an object called a \texttt{scree}. This is the basis for all
the other objects that are used to calculate the scagnostics (except for
monotonic, dcor and splines which use the raw data). The graph (screen
object) is then used to construct the three key structures on which the
scagnostics are based; the convex hull, alpha hull and minimum-spanning
tree (MST) (Figure @ref(fig:building-blocks2)).

\begin{itemize}
\item
  \textbf{Convex hull:} The outside vertices of the graph, connected to
  make a convex polygon that contains all points. It is constructed
  usnig the tripack package.
\item
  \textbf{Alpha hull:} A collection of boundaries that contain all the
  points in the graph. Unlike the convex hull, it does not need to be
  convex. It is calculated using the alphahull package
  \citep{alphahull}.
\item
  \textbf{MST:} the minimum spanning tree, i.e the smallest distance of
  branches that can be used to connect all the points. In the package it
  is calculated from the graph using the igraph package \citep{igraph}.
\end{itemize}

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/building-blocks2-1} \caption[The building blocks for graph-based scagnostics]{The building blocks for graph-based scagnostics: (a) convex hull, (b) alpha hull and (c) minimal spanning tree. The convex hull is a convex shell around all the data points. The alphahull contains all the points but allows concavities better capturing some shapes, but it needs tuning. The minimal spanning tree connects all points once, and has a single chain connecting central points.}(\#fig:building-blocks2)
\end{figure}
\end{Schunk}

\hypertarget{graph-based-scagnostics}{%
\subsection{Graph-based scagnostics}\label{graph-based-scagnostics}}

The nine scagnostics defined in \emph{Scagnostic Distributions} are
detailed below with an explanation, formula, and visualisation. We will
let \(A=\) alpha Hull, \(C=\) convex hull, \(M\) = minimum spanning
tree, and \(s=\) the scagnostic measure. Since some of the measures have
a sample size dependence, \(w\) is a parameter used to adjust for the
sample size.

\begin{itemize}
\tightlist
\item
  \textbf{Convex:} Measure of how convex the shape of the data is.
  Computed as the ratio between the area of the alpha hull (\(A\)) and
  convex hull (\(C\)). Unlike the other scagnostic measures, a high
  value on convex does not correlate to an interesting scatter plot,
  rather it usually indicates a lack of relationship between the two
  variables.
\end{itemize}

\[s_{convex}=w\frac{area(A)}{area(C)}\]

\begin{itemize}
\tightlist
\item
  \textbf{Skinny:} A measure of how ``thin'' the shape of the data is.
  It is calculated as the ratio between the area and perimeter of the
  alpha hull (\(A\)) with some normalisation such that 0 correspond to a
  perfect circle and values close to 1 indicate a skinny polygon.
\end{itemize}

\[s_{skinny}= 1-\frac{\sqrt{4\pi area(A)}}{perimeter(A)}\]

\begin{itemize}
\tightlist
\item
  \textbf{Outlying:} A measure of proportion and severity of outliers in
  dataset. Calculated by comparing the edge lengths of the outlying
  points in the MST with the length of the entire MST.
\end{itemize}

\[s_{outlying}=\frac{length(M_{outliers})}{length(M)}\]

\begin{itemize}
\tightlist
\item
  \textbf{Stringy:} This measure identifies a ``stringy'' shape with no
  branches, such as a thin line of data. It is calculated by comparing
  the number of vertices of degree two (\(V^{(2)}\)) with the total
  number of vertices (\(V\)), dropping those of degree one
  (\(V^{(1)}\)).
\end{itemize}

\[s_{stringy} = \frac{|V^{(2)}|}{|V|-|V^{(1)}|}\]

\begin{itemize}
\tightlist
\item
  \textbf{Skewed:} A measure of skewness in the edge lengths of the MST
  (not in the distribution of the data). It is calculated as the ratio
  between the 40\% IQR and the 80\% IQR, adjusted for sample size
  dependence.
\end{itemize}

\[s_{skewed} = 1-w(1-\frac{q_{90}-{q_{50}}}{q_{90}-q_{10}})\]

\begin{itemize}
\tightlist
\item
  \textbf{Sparse:} Identifies if the data is sporadically located on the
  plane. Calculated as the 90th percentile of MST edge lengths.
\end{itemize}

\[s_{sparse}= wq_{90}\]

\begin{itemize}
\tightlist
\item
  \textbf{Clumpy:} This measure is used to detect clustering and is
  calculated through an iterative process. First an edge J is selected
  and removed from the MST. From the two spanning trees that are created
  by this break, we select the largest edge from the smaller tree
  (\(K\)). The length of this edge (\(K\)) is compared to the removed
  edge (\(J\)) giving a clumpy measure for this edge. This process is
  repeated for every edge in the MST and the final clumpy measure is the
  maximum of this value over all edges.
\end{itemize}

\[\max_{j}[1-\frac{\max_{k}[length(e_k)]}{length(e_j)}]\]

\begin{itemize}
\tightlist
\item
  \textbf{Striated:} This measure identifies features such as
  discreteness by finding parallel lines, or smooth algebraic functions.
  Calculated by counting the proportion of acute (0 to 40 degree) angles
  between the adjacent edges of vertices with only two edges.
\end{itemize}

\[\frac1{|V|}\sum_{v \in V^{2}}I(cos\theta_{e(v,a)e(v,b)}<-0.75)\]

\hypertarget{association-based-scagnostics}{%
\subsection{Association-based
scagnostics}\label{association-based-scagnostics}}

\begin{itemize}
\tightlist
\item
  \textbf{Monotonic:} Checks if the data has an increasing or decreasing
  trend. Calculated as the Spearman correlation coefficient, i.e.~the
  Pearson correlation between the ranks of x and y.
\end{itemize}

\[s_{monotonic} = r^2_{spearman}\]

The two additional scagnostics discussed by Katrin Grimm are described
below.

\begin{itemize}
\tightlist
\item
  \textbf{Splines:} Measures the functional non-linear dependence by
  fitting a penalised splines model on \(X\) using \(Y\), and on \(Y\)
  using \(X\). The variance of the residuals are scaled down by the axis
  so they are comparable, and finally the maximum is taken. Therefore
  the value will be closer to 1 if either relationship can be decently
  explained by a splines model.
\end{itemize}

\[s_{splines}=\max_{i\in x,y}[1-\frac{Var(Residuals_{model~i=.})}{Var(i)}]\]

\begin{itemize}
\tightlist
\item
  \textbf{Dcor:} A measure of non-linear dependence which is 0 if and
  only if the two variables are independent. Computed using an ANOVA
  like calculation on the pairwise distances between observations.
\end{itemize}

\[s_{dcor}= \sqrt{\frac{\mathcal{V}(X,Y)}{\mathcal{V}(X,X)\mathcal{V}(Y,Y)}}\]\\
where \[\mathcal{V}
(X,Y)=\frac{1}{n^2}\sum_{k=1}^n\sum_{l=1}^nA_{kl}B_{kl}\]\\
where \[A_{kl}=a_{kl}-\bar{a}_{k.}-\bar{a}_{.j}-\bar{a}_{..}\]
\[B_{kl}=b_{kl}-\bar{b}_{k.}-\bar{b}_{.j}-\bar{b}_{..}\]

\hypertarget{checking-the-scagnostics-calculations}{%
\subsection{Checking the scagnostics
calculations}\label{checking-the-scagnostics-calculations}}

Once we have working functions that correctly calculate the scagnostics
according to their definition, we can assess how well they identify the
visual features of scatter plots. To test the packages ability to
differentiate plots, we have creates a dataset called ``features''
(Figure @ref(fig:features-plot)), that contains a series of interesting
and unique scatter plots which we can run our scagnostics on. These
scatter plots typify certain visual features we want to look for in
scatter plots, be it deterministic relationships (such as that shown in
the nonlinear feature), discreteness in variables (vlines), or
clustering (clumpy), we should be able to use scagnostics to identify
each of these scatter plots.

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/features-plot-1} \caption[The scatter plots of the features dataset]{The scatter plots of the features dataset. These scatter plots were designed to each represent a distinct visual feature, for example the ring scatter plot is a hollow version of disk. The scagnostics need to be able to differentiate these plots.}(\#fig:features-plot)
\end{figure}
\end{Schunk}

Figure @ref(fig:visual-table) shows scatter plots from the features data
aligned on a 0 to 1 scale for each scagnostic. This visualisation
displays a low, high, and moderate value for each scagnostic, and is
useful to see how the scagnostics order data that typifies their visual
feature. This plot gives a slight idea of the issues some of the
scagnostics face in their current state. The scagnostics are supposed to
range from 0 to 1 however in some cases the values are so compressed
that a moderate value would not fit, indicating that the scagnostics do
not work quite as intended. The scagnostics based upon the convex hull
(i.e.~skinny and convex) work fine, as do the association measures such
as montonic, dcor and splines. The main issue comes from the measures
based on the MST. We can see in the figure that the sparse, stringy,
skewed, and clumpy are each concentrated on a small portion of 0 to 1
number line. In addition to this, clumpy does not correctly order the
scatter plots, and while it is not visible here, striated also struggles
with a correct ordering. We suspect the reason for these warped
distributions is the removal of binning as a preliminary step in
calculating the scagnostics. The removal of binning allows for a large
number of arbitrarily small edges, which upon testing was found to be
the cause of a lot of these issues. Since many of these measures are
based on the percentile edge lengths, or the ratio between two edge
lengths, infintesimally small edges can warp the scagnsotics and
redefines what they identify. A summary of how binning warped each MST
scagnostic is provided in We wanted the package to have binning as an
optional method, considering choices in binning can lead to bias as
noted in \citet{scagdist} or unreproducible results as noted in
\citet{robust}. Therefore the current scagnostics will be assessed
without binning.

\begin{Schunk}
\begin{table}

\caption{(\#tab:scagissues-tb-pdf)Summary of MST scagnostic issues.}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
Scagnostic & Issues\\
\midrule
Striated & The striated measure can identify the specific case of one discrete variable and one continuous variable (which alone is not particularly interesting) but will not identify two discrete variables. Since by definition it is a subset of the stringy measure, they are highly correlated, and often plot that score highly on striated already score highly on stringy, making the measure less useful.\\
Sparse & While sparse does seem to identify spread out distributions, it rarely returns a value higher than 0.1. As this measure is the 90th percentile of MST edge lengths, and the removal of binning allows for a large number of arbitrarily small edges. In addiiton to this, a larger number of observations will arbitrarily make this value smaller. The addition of new points will increase the number of small edges and decrease the number of large edges, and it is rare that a significantly large edge will be at or below the 90th percentile.\\
Skewed & This measure can identify skewed edge lengths (such as the L shape in the visual table) however the values on real data rarely drop below 0.5 or rise above 0.8. Skewed seems to suffers from the same issue as sparse reguarding the binning issue and is also heavily influenced by the number of observations in the scatter plot.\\
Outlying & By definition an outlier must have all its adjacent edges in the MST above the outlying threshold. This means two or more observations that are close together but away from the main mass of data will not be identified as outliers because the points are close enough that all of them have at least one edge that is below the outlying threshold. Even if we changed the measure such that only one edge needed to be above the outlying threshold, it would only remove a single point. The measure also struggles to allow distributions with increasing variance due to the removal of binning. If the number of points close to the centre of the cluster is large enough, which is seen in the l-shape plot of features in the visual table, outlying identifies the spread out points to be outliers and returns a large value, despite human perception being unlikely to tag those points as outliers.\\
Stringy & This measure rarely drops below 0.5 even on data generated from a random normal distribution (which should intuitively return a 0). Unlike the other scagnostics on this list, stringy does not depend upon the edge lengths of the MST, so it is hard to say if this issue stems from binning.\\
\addlinespace
Clumpy & With the removal of binning, clumpy does noth identify a long edge connected to a short edge, but rather identifies any edge connected to an arbitrarily small edge. This means the clumpy measure rarely drops below 0.9, and also does not correctly order the edges.\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

The measures that do not seem to range uniformly from 0 to 1 still put
the scatter plots in the correct order and so do not urgently need
adjustments. In order to truely assess the distribution of these
functions, we would need to check the scagnostics on a large range of
data from muliple diciplines before claiming that the distribution is
truely warped by the removal of binning. Intuition on a small simulated
features data set is not enough. This is a large task that is beyond the
scope of this research, and so we will assume that the scagnsotics range
uniformly from 0 to 1. For some measures, removing the binning step
completely changes the visual feature the measure is identifying, unlike
the measures where the primary issue is their distribution, these
scagnostics need to be redefined. Therefore, in the section below we
will discuss the adjustments made to the striated and clumpy
scagnostics.

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/visual-table-1} \caption[A visual table of a selection of scagnostics computed on the features data]{A visual table of a selection of scagnostics computed on the features data. The rows correspond to different scagnostics and the horizontal axis is the calculated value on a range of 0-1. Thumbnail plots of variable pairs are placed at their scagnostic value, and indicate the type of structure that would produce high or low or medium values. Some scagnostics, e.g. clumpy, clearly need adjustment, while others, such as splines work well as they are. XXX DC: not sure I see this}(\#fig:visual-table)
\end{figure}
\end{Schunk}

\hypertarget{the-adjusted-scagnostics-measures}{%
\subsubsection{The Adjusted Scagnostics
Measures}\label{the-adjusted-scagnostics-measures}}

\hypertarget{striated-adjusted}{%
\paragraph{Striated adjusted}\label{striated-adjusted}}

The issues that need to be addressed with the new striated measure are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  By only counting vertices with 2 edges, the set of vertices counted in
  this measure are a subset of those counted in stringy, thus the two
  meaures are highly correlated.
\item
  In order for the vertex to be counted, the angle between the edges
  needs to be approximately 135 to 220 degrees. The original idea seems
  to have been to give an allowance for the binning, data on a line
  might end up slightly to either side if the boundary for the bins is
  exactly on the line the data follows. With the removal of binning this
  leeway is unecessary and many plots that are not discrete are
  identified as such.
\end{enumerate}

To account for these two issues the striated adjusted measure considers
all vertices (not just those with two adjacent edges), and makes the
measure strict around the 180 and 90 degree angles. With this we can see
the improvements on the measure in Figure @ref(fig:striated-vtable).

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/striated-vtable-1} \caption[Using a visual table to compare the striated and it's adjusted counterpart, striated2]{Using a visual table to compare the striated and it's adjusted counterpart, striated2. This plot compares the scagnostic value of a select group of scatter plots for striated and striated2. While the functions may seem similar at a glance, striated2 has a stricter version of discreteness, hence why line and vlines have the same result and plots with no discreteness score a 0.}(\#fig:striated-vtable)
\end{figure}
\end{Schunk}

Figure @ref(fig:striated-vtable) shows that while these two measures may
seem similar at a glace, there are a few minor things that make the
striated2 scagnsotic an improvement on the stirated scagnsotic. First of
all, the perfect 1 value on striated goes to the ``line'' scatter plot.
While this does fulfil the definition, it is not what the measure is
supposed to be looking for, rather supposed to be identifying the
``vlines'' scatter plot. Since striated does not count the right angles
that go between the vertical lines, a truely striated plot will never
get a full 1 on this measure, striated adjusted fixes this. After that
there is a large gap in both measures because none of the other scatter
plots have a strictly discrete measure on the x or y axis. The lower
plots show that striated2 is also better at identifying discrete
relationships with a rotation and noise added as shown in the
``discrete'' plot. In striated ``discrete'' is lower in the order than
``outlying'' which would indicate that striated has finished looking at
discreteness. In striated2, after the plots with strict discreteness in
``vlines'' or strict rotated disceteness in ``line'', is the noisey and
rotated ``discrete'' plot. Therefore in terms of ordering the plots in
how well they represent the feature of discreteness, striated2
outperforms striated.

The scagnostics need to be used and interpreted with the type of dataset
you are working with in mind. For if we are looking at a dataset that is
discrete, a very low value on striated2 would indicate some strange
relationship in the scatter plot. Since the old striated measure is
specifically trying to find a continuous variable against a discrete
variable, its highest values are also identified by the striated2. The
lowest values on striated simply identify a plot where all the variables
are at right angles, once again a measure of disceteness but one that is
not identified by striated. Striated2 encapsulates both versions of
discreteness in the values that get exactly a 1.

\hypertarget{clumpy-adjusted}{%
\paragraph{Clumpy adjusted}\label{clumpy-adjusted}}

The issues that need to be addressed with the new clumpy measure are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  It needs to consider more than 1 edge in its final measure to make the
  measure more robust
\item
  The impact of the ratio between the long and short edges need to be
  weighted by the size of their clusters so the measure does not simply
  identify outliers
\item
  It should not consider vertices that's adjacent angles form a straight
  line (to avoid identifying the angles striated identifies)
\end{enumerate}

Before we calculated a new clumpy measure, we looked into applying a
different adjustment defined in the \emph{Improving the robustness of
scagnostics} that is a robust version of the original clumpy measure
\citep{robust}. This version of clumpy has been included in the package
as \texttt{clumpy\_r} however it is not included as an option in the
higher level functions such as \texttt{calc\_scags()} because its
computation time is too long. This measure tries to build multiple
clusters, each having their own clumpy value, and then returns the
weighted sum, where each value is weighted by the number of observations
in that cluster. This version of clumpy spreads the scatter plots more
evenly between 0 and 1 and is more robust to outliers, however it does a
poor job of ordering plots generally considered to be clumpy without the
assistance of binning. Since this scagnostic cannot be used in large
scale scagnostic calculations (such as those done on every pairwise
combination of variables as is intended by the package) and it maintains
the ordering issue from the original measure, it is not discussed here.

Therefore in order to fix the issues in the clumpy measure described
above, we designed an adjusted clumpy measure, called clumpy2 in the
package, and it is calculated as follows:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Sort the edges in the MST
\item
  Calculate the difference of adjacent vectors in this ordering, and
  find the index of the maximum. This maximum difference should indicate
  the jump from between cluster edges and inter-cluster edges.
\item
  Remove the between cluster edges from the MST and build clusters using
  the remaining edges
\item
  For each between cluster edge, take the smaller cluster (in number of
  observations) and take its median edge length. The clumpy value for
  that edge is the ratio between the large and small edge lengths
  \(\frac{edge_{small}}{edge_{large}}\), with a two multiplicative
  penaltys, one for uneven clusters
  \(\frac{2\times n_{small}}{n_{small}+n_{big}}\), and one for
  ``stringy'' scatter plots that is only applied if the stringy value is
  higher than 0.95, to reduce the arbitrarily large clumpy scores that
  come from striated plots \(1-s_{stringy}\).
\item
  Take the mean clumpy value for each between cluster edge, if it is
  below 1 it is beneath the threshold that is consdiered clumpy, and the
  value is adjusted to 1.
\item
  Clumpy 2 returns \(1-\frac{1}{mean(clumpy_i)}\)
\end{enumerate}

With this calculation, we generate the clumpy2 measure which is compared
to the original clumpy measure in the Figure @ref(fig:clumpy-vtable).
Here we can see the improvements made on the clumpy measure in both
distribution from 0 to 1 and ordering. The measure is more spread out,
and so values range more accurately from 0 to 1. More importantly the
measures do a better job of ordering the scatter plots. On the original
clumpy measure the ``clusters'' scatter plot was next to last, on the
clumpy2 measure ``clusters'' is is identified as the most clumpy scatter
plot. Clumpy 2 also has a penalty for uneven clusters (to avoid being
large due to a small colelction of outliers) and clusters created
arbitrarily due to discreteness (such as vlines) in order to better
aling with the human interpretation of clumpy. With these changes, the
stronger performance of clumpy2 is apparent in this visual table.

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/clumpy-vtable-1} \caption[A visual table comparison of clumpy and clumpy2]{A visual table comparison of clumpy and clumpy2. This plot compares the scagnostic value of a select group of scatter plots for clumpy and clumpy2. It is clear that clumpy2 achieves a more ballanced distribution and more intuitive plot ordering.}(\#fig:clumpy-vtable)
\end{figure}
\end{Schunk}

\hypertarget{implementation}{%
\section{Implementation}\label{implementation}}

\hypertarget{installation}{%
\subsection{Installation}\label{installation}}

The package can be installed from CRAN using

\begin{quote}
\texttt{install.packages("cassowaryr")}
\end{quote}

and from GitHub using

\begin{quote}
\texttt{remotes::install\_github("numbats/cassowaryr")}
\end{quote}

to install the development version.

\hypertarget{web-site}{%
\subsection{Web site}\label{web-site}}

More documentation of the package can be found at the web site
\url{https://numbats.github.io/cassowaryr/}.

\hypertarget{data-sets}{%
\subsection{Data sets}\label{data-sets}}

The cassowaryr package comes with several data sets that load with the
package, they are described here.

\begin{Schunk}
\begin{table}

\caption{(\#tab:datasets-tb-pdf)Cassowaryr data sets}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
data & explanation\\
\midrule
features & Simulated data with special features.\\
anscombe\_tidy & Data from Anscombes famous example in tidy format.\\
datasaurus\_dozen & Datasaurus Dozen data in a long tidy format.\\
datasaurus\_dozen\_wide & Datasaurus Dozen Data in a wide tidy format.\\
numbat & A toy data set with a numbat shape hidden among noise variables.\\
\addlinespace
pk & Parkinsons data from UCI machine learning archive.\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

\hypertarget{functions}{%
\subsection{Functions}\label{functions}}

\hypertarget{scagnostics-functions}{%
\subsubsection{Scagnostics functions}\label{scagnostics-functions}}

The scagnostics functions functions either calculate each scagnostic
measure, or are involved in the process of calcuating a scanostic
measure (such as making the hull objects). These functions are low level
functions, and while they are exported and can be used, they are not the
intended method of calcuating scagnostics as they perform no outlier
removal, however they are still an option for users if they wish. In
some cases, such as sc\_clumpy\_r for clumpy robust, they are the only
method to calculate that scagnostic. the The functions in this group
are:

\begin{Schunk}
\begin{table}

\caption{(\#tab:scagfuncs-tb-pdf)Cassowaryr Scagnostic functions}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
Function & Explanation\\
\midrule
scree & Generates a scree object that contains the Delaunay triangulation of the scater plot.\\
sc\_clumpy & Compute the original clumpy scagnostic measure.\\
sc\_clumpy2 & Compute adjusted clumpy scagnositc measure.\\
sc\_clumpy\_r & Compute robust clumpy scagnostic measure.\\
sc\_convex & Compute the original convex scagnostic measure\\
\addlinespace
sc\_dcor & Compute the distance correlation index.\\
sc\_monotonic & Compute the Spearman correlation.\\
sc\_outlying & Compute the original outlying scagnostic measure.\\
sc\_skewed & Compute the original skewed scagnostic measure.\\
sc\_skinny & Compute the original skinny scagnostic measure.\\
\addlinespace
sc\_sparse & Compute the original sparse scagnostic measure.\\
sc\_sparse2 & Compute adjusted sparse measure.\\
sc\_splines & Compute the spline based index.\\
sc\_striated & Compute the original stirated scagnostic measure.\\
sc\_striated2 & Compute angle adjusted striated measure.\\
\addlinespace
sc\_stringy & Compute stringy scagnostic measure.\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

\hypertarget{drawing-functions}{%
\subsubsection{Drawing functions}\label{drawing-functions}}

The drawing functions are intended to be used my the user so they can
better understand the results of the scagnostic functions. The input is
two numeric vectors and the output is a ggplot object that draws the
graph based object in question. The functions that belong to this group
are:

\begin{Schunk}
\begin{table}

\caption{(\#tab:drawfuncs-tb-pdf)Cassowaryr drawing functions}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
Function & Explanation\\
\midrule
draw\_alphahull & Drawing the alpha hull.\\
draw\_convexhull & Drawing the convex hull.\\
draw\_mst & Drawing the MST.\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

\hypertarget{calculate-functions}{%
\subsubsection{Calculate functions}\label{calculate-functions}}

The summary functions are the perferred method for users to calculate
scagnostics. The \texttt{calc\_scags()} function is supposed to be used
on long data with the dplyr group\_by and summarise functions. the
\texttt{calc\_scags\_wide()} functions is designed to take in a tibble
of numerical variables and return the scagnostics on every possible
pairwise scatter plot. Both functions return a tibble where each column
is a scagnostics. These are the two main functions of the package.

\begin{Schunk}
\begin{table}

\caption{(\#tab:dsumfuncs-tb-pdf)Cassowaryr summary functions}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
Function & Explanation\\
\midrule
calc\_scags & Compute selected scagnostics on subsets.\\
calc\_scags\_wide & Compute scagnostics on all possible scatter plots for the given data.\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

The main arguments of the \texttt{calc\_scags()} function are shown in
Table @ref(tab:calcfunc-tb-pdf).

\begin{Schunk}
\begin{table}

\caption{(\#tab:calcfunc-tb-pdf)The main arguments for calc\_scags().}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
Argument & Explanation\\
\midrule
y & numeric vector of x values.\\
x & numeric vector of y values.\\
scags & collection of strings matching names of scagnostics to calculate: outlying, stringy, striated, striated2, striped, clumpy, clumpy2, sparse, skewed, convex, skinny, monotonic, splines, dcor. The default is to calculate all scagnostics.\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

While the \texttt{calc\_scags()} function does not take in a tibble, it
is designed to be seamlessly integrated into the tidy data work flow.
Currently to specify the scagnostics on long form tidy data using
\texttt{summarise()} requires \texttt{group\_by()}, computing all the
scagnostics, and then selecting just the ones of interest to display,
using \texttt{select()}. The reason is that the argument for
\texttt{calc\_scags()} is not currently recognised inside
\texttt{summarise()}. The code below generates the summary data in Table
@ref(tab:featuresscags-pdf).

\begin{Schunk}
\begin{Sinput}
features_scags <- features %>%
  group_by(feature) %>%
  summarise(calc_scags(x,y)) %>%
  select(c(feature, outlying, clumpy2, monotonic))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{table}

\caption{(\#tab:featuresscags-pdf)Summary of three scagnostics computed by calc\_scags() on the long form of the features data.}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}rrr}
\toprule
feature & outlying & clumpy2 & monotonic\\
\midrule
barrier & 0.00 & 0.00 & 0.35\\
clusters & 0.06 & 0.83 & 0.03\\
discrete & 0.00 & 0.00 & 0.01\\
disk & 0.02 & 0.40 & 0.09\\
gaps & 0.00 & 0.75 & 0.06\\
\addlinespace
l-shape & 0.38 & 0.00 & 0.48\\
line & 0.11 & 0.00 & 1.00\\
nonlinear1 & 0.27 & 0.00 & 0.17\\
nonlinear2 & 0.00 & 0.00 & 0.81\\
outliers & 0.00 & 0.52 & 0.71\\
\addlinespace
outliers2 & 0.59 & 0.00 & 0.06\\
positive & 0.14 & 0.29 & 0.92\\
ring & 0.02 & 0.45 & 0.04\\
vlines & 0.00 & 0.17 & 0.08\\
weak & 0.05 & 0.00 & 0.41\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

\hypertarget{making-summaries}{%
\subsubsection{Making summaries}\label{making-summaries}}

We are also considering an additional two summary functions that could
be introduced to the package. While the code required to write them is
simple and easily performed by the user, having them as ready functions
in the package would help guide users to use the package most
effectively. The two additional functions that have not yet been
implemented into the package are \texttt{calc\_topscags()} and
\texttt{calc\_toppairs()} which are described in \textbf{table}.

\begin{Schunk}
\begin{table}

\caption{(\#tab:exsumfuncstb-pdf)Additional summary functions}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{3cm}l}
\toprule
Function & Explanation\\
\midrule
calc\textbackslash{}\_topscags & Return the top scagnostic value for each pair of variables\\
calc\textbackslash{}\_toppairs & Return the top pair of variables for each scagnostic\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

The code for both are simple, but an example of how to calculate
\texttt{calc\_toppairs()} with its output will be shown here. In this
case it is the top groups, but the main idea is the same as if we had
used \texttt{calc\_scags()} wide to generate pairs of variables.

\begin{Schunk}
\begin{Sinput}
features_toppairs <- features_scags %>% 
  pivot_longer(!feature, names_to = "scag", values_to = "value") %>%
  arrange(desc(value)) %>% 
  group_by(scag) %>%
  slice_head(n=1)
\end{Sinput}
\end{Schunk}

\begin{Schunk}

\begin{tabular}{>{\raggedright\arraybackslash}p{3cm}lr}
\toprule
feature & scag & value\\
\midrule
clusters & clumpy2 & 0.83\\
line & monotonic & 1.00\\
outliers2 & outlying & 0.59\\
\bottomrule
\end{tabular}

\end{Schunk}

\hypertarget{tests}{%
\subsection{Tests}\label{tests}}

All the functions that calculate the scagnostic measures (all the
measures that start with ``sc'') have tests written and implemented
using the testthat package. They have all been compared to calculations
completed by hand to ensure the difference in results from previous
literature are due to other steps in the process, such as binning, and
not a mistake in the write up of the code. These tests also illuminated
some issues that allowed us to make meaningful changes to the
definitions of the scagnostics and the implementation of the package.
For example, several tests to check the outying scagnostic was working
correctly illustrated some issues in the process of outlier removal,
which is illustrated in Figure @ref(fig:outlying-test-plot).

Figure @ref(fig:outlying-test-plot) shows the an example of a simulated
test set, combined with the associated MST. When creating this test data
set, we assumed the MST would connect via the red line, but instead the
MST connected via the long black line. The difference between these
choices is essentially random, they are the exact same length, but it
has significant implications for the value returned by the outlying
scagnostic. This test was designed to check the outlier removal process
for internal outliers, point 1 should have been identified as an
internal outlier which means both its edges were considered in the
calculation of outlying, and points 2 and 3 are too close to each other
for either to fulfill the outlying definition, so they are left alone.
Using the \texttt{draw\_mst()} function when the test failled showed the
issue was an esentially random desicionin the MST construction. If the
red line was used to construct the MST, both the red dashed line, and
the line connecting point 1 to point 2 would be included in the outlying
scagnostic calcuation, in the actual calculation it was only the edge
between points 1 and 2, giving a significantly smaller value on the the
outlying scagnostic. This shows that even the scagnostics that work
reliably well and did not need significant adjustments are still
succeptible to arbitrarily large changes resulting from seemingly small
changes in the visual structure of the scatter plot.

\begin{Schunk}
\begin{figure}
\includegraphics[width=0.8\linewidth]{mason-lee-laa-cook_files/figure-latex/outlying-test-plot-1} \caption[Plot of simulated data used for testing the 'outlying' scagnostic]{Plot of simulated data used for testing the 'outlying' scagnostic. The left plot shows the raw data, while the right plot presents the MST generated on that data. The edges that make it into the MST can be random and also have serious implications for outlier scagnostic. If the red edge is in the MST rather than the black edge that connects to 3, the outlying value on this plot is much higher.}(\#fig:outlying-test-plot)
\end{figure}
\end{Schunk}

\hypertarget{examples}{%
\section{Examples}\label{examples}}

\hypertarget{afl-player-statistics}{%
\subsection{AFL player statistics}\label{afl-player-statistics}}

The Australian Football League Women's (AFLW) is the national
semi-profesisonal Australia Rules football league for female players.
Here we will analyse data sourced from the official AFL website with
information on the 2020 season, in which the league had 14 teams and
1932 players. These variables are recorded per player per game, so the
stats are averaged for each player over the course of the season. The
description of each statistic data set can be found in the Appendix.
There are 68 variables, 33 of which are numeric, the others are
categorical, e.g.~players names or match ids, and they would not be used
in scagnostic calculations. This means there are 528 possible
scatterplots, significantly more than a single person could view and
analyse themselves and so we use scagnostics to identify which pairwise
plots might be interesting to examine.

Figure @ref(fig:AFLW-scatters-static) displays 5 scatter plots (Plots 1
to 5 in the figure) that were identified as having a particularly high
or low value on a scagnostic, or an unusual combination of two or more
scagnostics. In addition to these 5, there is a 6th plot (Plot 6 in the
figure) that is included to display what a middling value on almost all
of the scagnostics looks like. Most scatter plots score middling values
on the scagnostics, so Plot 6 is a good indication of what we would look
at if we picked variables to plot ourselves with no intuition. The
visual structure that changes significantly between Plots 1 to 5, and
the lack of interesting visual features in Plot 6, shows the benefit of
using scagnostics in early stages of exploratory data analysis. Extreme
values on the scagnostic measurements identify atypical scatter plots.

\begin{Schunk}
\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{mason-lee-laa-cook_files/figure-latex/AFLW-scatters-static-1} 

}

\caption[Six AFLW sport statistic scatter plots that were identified as identified as interesting by the scagnostics]{Six AFLW sport statistic scatter plots that were identified as identified as interesting by the scagnostics. Plots 1 to 5 had unique values an individual or pair of scagnostics, Plot 6 had middling values on all measures. There is a clear difference in structure between these plots that was identified by the scagnostics.}(\#fig:AFLW-scatters-static)
\end{figure}
\end{Schunk}

The best way to identify interesting scatter plots using scagnostics is
to construct a large interactive SPLOM. This is how Plots 1 to 5 were
identified, but for the sake of space, we are only going to show the
specific scatter plots of the SPLOM that led to the selection of Plots
1, 2, and 5.

Figure @ref(fig:threeplot-static) displays Plot 1, Plot2 and Plot 5
beneath the specific scatter plot of the scagnostics SPLOM that was used
to identify the plot as interesting. Plot 1 was identifies as
interesting as it returned high values on both outlying and skewed.
Intuitively, this would indicate that even after removing outliers, the
data was still disproportionately spread out, a visual feature that we
can see very clearly in Plot 1. Plot 2 scored very highly on all the
association measures, which indicates a strong relationship between the
two variables. The three association measures typically have strong
correlation and scatter plots that stay within the large mass in the
center have a linear relation, those that don't often have a non-linear
relationship. The splines vs dcor plot tells us that there is a strong
linear relationship between total posessions and disposals. Total
possessions is the number of times the player has the ball and disposals
is the number of times the player gets rid of the ball legally, so the
strong linear relation indicates the level of play, i.e.~few mistakes
are made in a professional league. Plot 5 an excellent example in what
new information we can learn from a unique plot identified with
scagnostics. This plot is high on striated2 and moderate to low on
outlying, telling us most of the points will be at straight or right
angles and a little spread out. If a specific sports statistic is
related to position, we would see a relationship have a lower triangular
structure similar to that of Plot 4, however this plot does not have a
lower triangular structure, is has an L-shape. This means these
statistics are not about position, but rather the physical abilities of
the players. Hitouts measure the number of times the player punches the
ball after the referee throws it back into play, bounces have to be done
while running, and are typically done by fast players. The L-shape tells
us that players who do one very rarely perform the other. The moderate
spread along both of the statistics tells us these are both somewhat
specialised skills, and the players who specialise in one do not
specialise in the other, i.e.~in AFL the tallest player in the team is
rarely the fastest. These plots provide a clear example in the unique
information gained using scagnostics as a tool in exploratory data
analysis.

\begin{Schunk}
\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{mason-lee-laa-cook_files/figure-latex/threeplot-static-1} 

}

\caption[Three plots that were identified as interesting with the scagnostic scatter plot used to identify it]{Three plots that were identified as interesting with the scagnostic scatter plot used to identify it. Each scatter plot of AFLW data is displayed below a plot of the two scagnostic measures it stood out on. One of the most useful ways to identify plots is through scatter plots of the scagnostics.}(\#fig:threeplot-static)
\end{figure}
\end{Schunk}

\hypertarget{black-hole-mergers}{%
\subsection{Black hole mergers}\label{black-hole-mergers}}

Physics data often contains multiple variables with highly non-linear
pairwise relationships that often also have a large amount of
clustering, which makes this type of data ideal for investigating the
capability of the splines and clumpy2 scagnostics. Two scagnostics
that's uses were not particularly visible in the AFLW example. Here we
will use scagnostics to study a simulated dataset that contains
posterior samples describing a gravitational waves signal from a black
hole merger. The data contains 13 variables that describe (what event),
the explanation of each can be found in the appendix. In this example
looking at the complete SPLOM is still feasible, and could be used to
identify several interesting scatterplots and the corresponding
combination of variables. Most notably we can see non-linear and
non-functional relations between pairs of variables, and we expect that
these should stand out on the scagnostics measures as well. The full
data file contains 9998 posterior samples, without binning it is too
long to compute the scagnostics on such a large number of observations.
For our purpose a much smaller sample is sufficient, and we randomly
sample 200 observations before computing the scagnostics. We will focus
on the structures we know exist by looking at which scatter plots
significant difference in their splines and dcor values, as well as
which plots stand out on the clumpy2 measure.

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/bbh-scags-static-1} \caption[Pairs of scagnostics computed for the black hole mergers data]{Pairs of scagnostics computed for the black hole mergers data. XXX}(\#fig:bbh-scags-static)
\end{figure}
\end{Schunk}

Figure @ref(fig:bbh-scags-static) shows scatterplots of the computed
scagnostics measures, where several combinations stand out. On the left
plot we see three points with very low values of the convex measure and
high values of skinny. These are all possible combinations containing
the variables time, ra and dec, and the corresponding scatterplots are
shown in the upper row of Figure @ref(fig:blackholes). Because of how a
single experiment observes the sky, there is an interesting pattern
between these variables, with posterior samples being drawn along a
non-linear band in this three-dimensional space.

These variables also stand out in the middle plot of Figure
@ref(fig:bbh-scags-static), where it is interesting to note that the
cominations with non-linear but functional relation (time vs ra and dec
vs ra) have somewhat higher values in the splines measure compared to
dcor. On the other hand dec vs time does not exhibit a functional
relation, and consequently gets a higher dcor score compared to splines
(with both measures still taking large values). This also happens for
two other combinations: m1 vs m2 and chi\_p vs chi\_tot, which are shown
in the bottom row (left and middle) of Figure @ref(fig:blackholes). We
see that both these combinations show noisy linear relations.

Another interesting aspect with this dataset is that there are several
combinations that lead to visible separations between groups of points.
It is thus an ideal testcase for our new implementation of clumpy2. The
right plot in Figure @ref(fig:bbh-scags-static) shows clumpy vs clumpy2,
and reveals large differences between the two measures. In particular
there are many combinations without visible clustering, that still score
high on clumpy, but where clumpy2 is zero. On the other hand we can see
that there are several combinations that do lead to visible separation
between groups that stand out in terms of clumpy2, but not the original
clumpy. One example is time vs alpha, shown in the bottom right plot of
Figure @ref(fig:blackholes).

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/blackholes-1} \caption[Features in the BBH data that stand out on several of the scagnostics measures (convey, skinny, splines and dcor), showing strong relations between variables including non-linear and non-functional dependencies]{Features in the BBH data that stand out on several of the scagnostics measures (convey, skinny, splines and dcor), showing strong relations between variables including non-linear and non-functional dependencies. The final example (time vs alpha) is expected to take high values in clumpy, but only stands out on the corrected clumpy2.}(\#fig:blackholes)
\end{figure}
\end{Schunk}

\hypertarget{shape-differences-between-groups}{%
\subsection{Shape Differences Between
Groups}\label{shape-differences-between-groups}}

A potential application of scagnostics is to detect shape differences
between groups. Commonly, classification focuses on differences in the
means, or separations between groups, there are few techniques that
focus on difference in shape. This difference in shape occurs when the
variance patters between groups are different, and quadratic
discriminant analysis (QDA), is a classical example of a method that
takes this difference in variance into consideration. QDA assumes the
distribution of each group is normal, and then draws a curved boundary
between them that is furthest from each groups mean, but also respects
that one group might have a larger elliptical variance-covariance than
another group. While this method is useful when groups have different
shapes, the technique is still limited by an assumption of normality.
Scagnostics could be utilised in a similar fashion to QDA to identify
irregular shape differences between.

This analysis compares the features of two large collections time
series, and then tries to differentiate them using scagnostics. The goal
of the comparison is to compare shapes, not necessarily centres of
groups as might be done in LDA or other machine learning methods. The
two groups chosen for comparison are macroeconomic and microeconomic
series. The data is pulled from the self-organizing database of
time-series data \citep{sots}, using the compenginets R package
\citep{compenginets}. Since the time series are different lengths, each
is described by a set of time series features \citep[chapter 4
of][]{fpp} using the feasts R package \citep{feasts}.

For illustration, just a small set of features is examined, but still
enough that the list of scatter plots identified by the scagnostics is
significantly smaller than the list of all possible scatter plots.
\textbf{Table} shows the pair of features that maximises the difference
between groups for each scagnostic. Plotting a handful of these in
(Figure @ref(fig:timeseries)), we can see the difference in shape that
the scagnostics have identified. For example, the difference between the
curvature and trend strength features shows both types of time series
have, on average, strong trends and moderate curvature, however the
former varies more in the macroeconomic series and the later in the
microeconomic series. We can see from this example, and the other
comparisons in the plot, that the scagnostics have identified a
difference in shape that is not apparent in the mean of the data.
Similar comments can be made about the other two plots in Figure
@ref(fig:timeseries).

While we have shown that the scagnostics succeed in identifying
difference in shapes between groups, this does not automatically
transfer to a classification technique. Utilising the scagnostics
ability to identify between group shape differences is an early step in
using them for classification. It is not uncommon for surpervised
learning methods to be born from unsupervised learning methods. For
example, principal component analysis transforms a dataset by making
linear combinations of the old variables in the direction of most
variance, and using these transformed variables in a linear regression
can improve results. However, despite its promise, developing a
classification technique is beyond the scope of this research.

\begin{Schunk}

\begin{tabular}{l|l|l|r|r|r}
\hline
Var1 & Var2 & scags & macro\_value & micro\_value & scag\_dif\\
\hline
acf1 & trend\_strength & clumpy2 & 0.83 & 0.00 & 0.83\\
\hline
longest\_flat\_spot & trend\_strength & convex & 0.12 & 0.62 & 0.50\\
\hline
pacf5 & diff1\_acf1 & outlying & 0.32 & 0.71 & 0.39\\
\hline
curvature & trend\_strength & skewed & 0.66 & 0.84 & 0.19\\
\hline
longest\_flat\_spot & trend\_strength & skinny & 0.64 & 0.37 & 0.27\\
\hline
acf1 & trend\_strength & sparse & 0.04 & 0.11 & 0.07\\
\hline
pacf5 & acf1 & splines & 0.88 & 0.00 & 0.88\\
\hline
longest\_flat\_spot & diff1\_acf1 & striated2 & 0.13 & 0.06 & 0.06\\
\hline
diff1\_acf1 & trend\_strength & stringy & 0.84 & 0.73 & 0.11\\
\hline
\end{tabular}

\end{Schunk}

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/timeseries-1} \caption[Interesting differences between two groups of time series detected by scagnostics]{Interesting differences between two groups of time series detected by scagnostics. The time series are described by time series features, in order to handle different length series. Scagnostics are computed on these features separately for each set to explore for shape differences.}(\#fig:timeseries)
\end{figure}
\end{Schunk}

\hypertarget{processing-and-describing-data-with-many-variables}{%
\subsection{Processing and describing data with many
variables}\label{processing-and-describing-data-with-many-variables}}

The World Bank delivers a lot of development indicators (WBI)
\citep{WBI}, for many countries and multiple years. The sheer volume of
indicators, in addition to the substantial number of missing values,
presents a barrier to analysis. This is a good example to where
scagnostics can be used to identify pairs of indicators with interesting
relationships, and efficiently handle missing values on a pairwise
basis.

The example uses indicators from 2018 for a number of countries. The
downloaded data needs some pre-processing, to remove variables which
have mostly missing values, and countries which have mostly missing
values. The scagnostics will be calculated on the pairwise complete
data, allowing for a few sporadic missings. After pre-processing, there
are 20 indicators (variables) and 79 countries.

\begin{Schunk}
\begin{figure}
\includegraphics[width=1\linewidth]{mason-lee-laa-cook_files/figure-latex/wbistatic-1} \caption[The range of scagnostics calculated on data with a large number of variables can help to inform the analyst about the types of relationships present]{The range of scagnostics calculated on data with a large number of variables can help to inform the analyst about the types of relationships present. The side-by-side dotplot (left) shows one point for each pair of variables, with its highest scagnostic value among all scagnostics calculated. Most of the pairs of indicators exhibit outliers, skewed, stringy or convex. There is one pair that has clumpy as the highest value. The plots middle and right show the pair of variables with highest value on clumpy2 and convex respectively.}(\#fig:wbistatic)
\end{figure}
\end{Schunk}

Figure @ref(fig:wbistatic) (left plot) shows a summary of the top
scagnostic value for each pair of variables. That is, only the highest
value on any scagnostic for each pair of variables is saved. This is
displayed as a vertically-oriented side-by-side dotplot. For the WBI
data, the pairs of variables are producing mostly high values on
stringy, skewed, convex and outlying. The scagnostics clumpy2,
striated2, and skinny are only the highest for a single pair of
variables. In addition, missing from the plot but not the calculations
is that splines and striped were not highest for any pair of variables
in the data set.

This tells us that in the WBI data, the relationships between variables
is dominated by outliers (outlying scagnostic, and to some extent also
reflected by skewned and stringy), and no relationship (convex).
Scagnostics might be useful for obtaining alternative descriptive
summaries of data with many variables.

The middle and right plots of Figure @ref(fig:wbistatic) show the pair
of variables where clumpy2 has the highest value, and where convex has
the highest value, respectively. This tells us that the data is not very
clumpy.

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

Scagnostics are a useful tool to identify the visual features in scatter
plots. By building upon the earlier work, we have successfully
implemented previously defined scagnostics into the \emph{cassowaryr}
package, and adjusted some of them so they continue to work without a
pre-processing binning step. The package is shown to work, with details
on its functions, the testing process and its possible applications. We
displayed these applications by giving four examples. The first, AFLW
was designed to show the general use of the \emph{cassowaryr} package,
and show how to best use scagnostics to find unique scatter plots. In
this example we also showed that looking at specific pairwise scatter
plots can give us valuable information about our dataset, namely by
interpreting the \emph{hitouts vs bounces} scatter plot in Figure
@ref(fig:threeplot-static) . Using simulated data of a black hole
merger, we then displayed the packages ability to identify pairwise
non-linear relationship with splines and dcor, as well as the
improvement clumpy2 made in identifying clustering. The time series
example displayed the packages value as a method of classification where
it successfully identified scatter plots where the macro and micro
economic time series had different shape. Finally the scagnostics were
applied to the World Bank indicators to show how the scagnostics can be
used to product an overall ``shape summary'' of a data set.

The greatest limitation in this project was the 1 year time limit on the
research. When the presenting the research proposal, I thought there
would be time to code up all the original scagnositcs, fix any issues
with them, implement binning as an option, and have time left over to
create scagnostics completely of my own design. This clearly did not
occur. Ultimately coding up the previous scagnostics was more time
consuming than I originally thought it would be, expecially because
there was a fair bit of room for interpretation on some of the
scagnostics. For example, skinny and convex do no specify what to do in
the event the alphahull has no area (this occurs when the data is on a
perfect straight line), and so we used intuition to set them to 1 and 0
respectively. Additionally, a large portion of the project was invisible
to me at the outset, such as the testing to ensure the scagnostics were
working according to definition, rounds of debugging, and meeting CRAN
requirements. These elements produced very little output but were
required for the rigour of the project. On top of this, to reduce
dependencies most of the functions were written only using base R, which
made the project more challenging. For these reasons, the software
aspect of this thesis narrowed in scope throughtout the year, however
the number of examples and applications increased, as we recognised new
ways the scagnostics could be used throughout the year. Ultimately the
final project is significantly different to its original goals, but it
contains an equal amount of work.

There is a large amount of future work that could build upon this
research. To start with, the distribution of the scagnostics have been
largely warped by the removal of binning as a preprocessing step. In the
World Bank indicators example, we made the assumption that the
scagnostics are all uniformly distributed from 0 to 1, however, looking
at some of our results as well as well as the visual table of the
features scatter plots (Figure @ref(fig:visual-table)), shows this may
not be the case. It would be a substantial task to identify the
distributions of the scagnostics, and make adjustments to rectify any
irregularities. The scagnostics would need to be reassessed using large
volumes of data to ensure the measures are not simply identifying the
structures of that data set. Looking only at the outlying scagnostic on
the features data may lead us to beleive that the maximum outlier value
is 0.5 and its distribution is warped, however other data sets in this
paper had scatter plots that measured a perfect 1 on outlying. Without
this wide variety of data it is difficult for us to make comments on the
spread of the scagnostics. Scagnostics could also be expanded to be the
basis of a classification technique that identifies shape differences in
groups. While we showed in the time series example that scagnostics can
identify shape differences between groups, expanding that observation to
stand alone classification technique is outside the scope of this
research. \emph{Transforming Scagnostics to Reveal Hidden Features}
(\citet{hidscags}) showed that scagnostics can be used to identify
useful structure in pairwise plots after transformations such as log or
logit transformations. This paper showed a possible natural extension
for the scagnostics in the original code, but could also be considered a
natural extension of the cassowaryr package. Finally, there are a
handful of scagnostics that are used in the projection pursuit in the
\emph{tourr} package to find the best view of a large number of
variables. The scagnostics described here could also be implemented into
the package to improve the projection pursuit. Previously scagnostics
have has a large amount of noise (i.e.~the tourr struggles to reliably
move in the direction that will have the greatest increase in the
scagnostic) and checking if these scagnostics maintain that issue, and
developing them to negate this issue, is another possible area of future
research. It is clear from this list that there is a significant amount
of research that could be built upon this scagnostics.

\begin{verbatim}
\end{verbatim}

\bibliography{mason-lee-laa-cook.bib}

\address{%
Harriet Mason\\
Monash University\\%
Department of Econometrics and Business Statistics\\ Melbourne,
Australia\\
%
\url{https://www.britannica.com/animal/quokka}\\%
\textit{ORCiD: \href{https://orcid.org/0000-1721-1511-1101}{0000-1721-1511-1101}}\\%
\href{mailto:hmas0003@student.monash.edu}{\nolinkurl{hmas0003@student.monash.edu}}%
}

\address{%
Stuart Lee\\
Genentech\\%
\\
%
\url{https://stuartlee.org}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0003-1179-8436}{0000-0003-1179-8436}}\\%
\href{mailto:stuart.andrew.lee@gmail.com}{\nolinkurl{stuart.andrew.lee@gmail.com}}%
}

\address{%
Ursula Laa\\
University of Natural Resources and Life Sciences\\%
Institute of Statistics\\ Vienna, Austria\\
%
\url{https://uschilaa.github.io}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0002-0249-6439}{0000-0002-0249-6439}}\\%
\href{mailto:ursula.laa@boku.ac.at}{\nolinkurl{ursula.laa@boku.ac.at}}%
}

\address{%
Dianne Cook\\
Monash University\\%
Department of Econometrics and Business Statistics\\ Melbourne,
Australia\\
%
\url{https://dicook.org}\\%
\textit{ORCiD: \href{https://orcid.org/000-0002-3813-7155}{000-0002-3813-7155}}\\%
\href{mailto:dicook@monash.edu}{\nolinkurl{dicook@monash.edu}}%
}
